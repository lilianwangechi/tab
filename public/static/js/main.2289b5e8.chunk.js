(this["webpackJsonpreact-rails-api-project-template-client"]=this["webpackJsonpreact-rails-api-project-template-client"]||[]).push([[0],{178:function(e,t,n){},256:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(40),i=n.n(c),r=n(95),s=(n(178),n(7)),o=(n(179),n(269)),l=n(156),j=n(8),u=n(1),b=n(61),d=n(264),O=n(268),h=n(260),m=n(262),f=n(6);var p=function(e){var t=e.onLogin,n=Object(a.useState)(!1),c=Object(s.a)(n,2),i=c[0],r=c[1],o=Object(a.useState)({email:"",password:""}),l=Object(s.a)(o,2),p=l[0],x=l[1],g=Object(a.useState)(!1),v=Object(s.a)(g,2),C=(v[0],v[1]),w=Object(a.useState)([]),y=Object(s.a)(w,2),S=y[0],T=y[1];function k(){r(!1)}function P(e){x(Object(u.a)(Object(u.a)({},p),{},Object(j.a)({},e.target.name,e.target.value)))}return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(b.a,{onClick:function(){r(!0)},children:"Sign In"}),Object(f.jsxs)(d.a,{title:"User Login",visible:i,onCancel:k,onOk:k,footer:null,children:[S.length>0?Object(f.jsxs)("div",{children:[S.map((function(e,t){return Object(f.jsx)(O.a,{message:e,type:"error"},t)})),Object(f.jsx)("p",{})]}):null,Object(f.jsxs)(h.a,{name:"login",labelCol:{span:6},wrapperCol:{span:16},autoComplete:"off",onFinish:function(){fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)}).then((function(e){C(!1),e.ok?e.json().then((function(e){return t(e)})):e.json().then((function(e){return T(e.errors)}))}))},children:[Object(f.jsx)(h.a.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please input your email!"}],children:Object(f.jsx)(m.a,{name:"email",onChange:P})}),Object(f.jsx)(h.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(f.jsx)(m.a.Password,{name:"password",onChange:P})}),Object(f.jsx)(h.a.Item,{wrapperCol:{offset:10,span:16},children:Object(f.jsx)(b.a,{htmlType:"submit",children:"Submit"})})]})]})]})};var x=function(e){var t=e.onLogin,n=Object(a.useState)(!1),c=Object(s.a)(n,2),i=c[0],r=c[1],o=Object(a.useState)({full_name:"",email:"",password:"",password_confirmation:""}),l=Object(s.a)(o,2),p=l[0],x=l[1],g=Object(a.useState)([]),v=Object(s.a)(g,2),C=v[0],w=v[1],y=Object(a.useState)(!1),S=Object(s.a)(y,2),T=(S[0],S[1]);function k(){r(!1)}function P(e){x(Object(u.a)(Object(u.a)({},p),{},Object(j.a)({},e.target.name,e.target.value)))}return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(b.a,{onClick:function(){r(!0)},children:"Create New Account"}),Object(f.jsxs)(d.a,{title:"User Registration",visible:i,onCancel:k,onOk:k,footer:null,children:[C&&C.length>0?Object(f.jsxs)("div",{children:[Object(f.jsx)(O.a,{message:C.map((function(e){return Object(f.jsx)("li",{children:e})})),type:"error"}),Object(f.jsx)("p",{})]}):null,Object(f.jsxs)(h.a,{name:"registration",labelCol:{span:9},wrapperCol:{span:16},autoComplete:"off",onFinish:function(){w([]),T(!0),fetch("/api/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)}).then((function(e){T(!1),e.ok?e.json().then((function(e){return t(e)})):e.json().then((function(e){return w(e.errors)}))}))},children:[Object(f.jsx)(h.a.Item,{label:"Full Name",name:"full_name",rules:[{required:!0,message:"Please input your full name!"}],children:Object(f.jsx)(m.a,{name:"full_name",onChange:P})}),Object(f.jsx)(h.a.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please input your email!"}],children:Object(f.jsx)(m.a,{name:"email",onChange:P})}),Object(f.jsx)(h.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(f.jsx)(m.a.Password,{name:"password",onChange:P})}),Object(f.jsx)(h.a.Item,{label:"Password Confirmation",name:"passwordconfirm",rules:[{required:!0,message:"Please confirm your password!"}],children:Object(f.jsx)(m.a.Password,{name:"password_confirmation",onChange:P})}),Object(f.jsx)(h.a.Item,{wrapperCol:{offset:10,span:16},children:Object(f.jsx)(b.a,{htmlType:"submit",children:"Submit"})})]})]})]})};var g=function(e){var t=e.onLogin;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{id:"landing",children:[Object(f.jsx)("img",{src:"https://doodleipsum.com/600?i=0e05d2d124e0a86b24727ce6006b739a",alt:"Living Area by Irene Falgueras"}),Object(f.jsx)("h1",{className:"animate__animated animate__rubberBand animate__repeat-2",children:"TAB-TAB-TAB"}),Object(f.jsx)("p",{children:"Spliting bills has never been this easy"}),Object(f.jsxs)(o.b,{direction:"vertical",children:[Object(f.jsx)(p,{onLogin:t}),Object(f.jsx)(x,{onLogin:t})]})]}),Object(f.jsx)(l.a,{type:"random",bg:!0})]})},v=n(259),C=n(266),w=n(275),y=n(20),S=n(265),T=n(172),k=n(10),P=n(261),I=n(77),_=n(271),N=n(272),F=n(270),E=n(273),L=n(274),A=n(267),q=n(257),D=n(164);var J=function(e){var t=e.item,n=e.handleDelete;return Object(f.jsx)("div",{children:Object(f.jsxs)("span",{id:"singleitem",children:[t.name," - $",t.price,Object(f.jsx)(b.a,{onClick:function(){return n(t.id)},style:{float:"right"},size:"small",icon:Object(f.jsx)(F.a,{})})]})})};var z=function(e){var t=e.tab,n=e.user,c=e.handleDeleteTab,i=e.handleSettle,r=Object(a.useState)(!1),l=Object(s.a)(r,2),j=l[0],u=l[1],O=Object(a.useState)(!1),p=Object(s.a)(O,2),x=p[0],g=p[1],v=Object(a.useState)(""),C=Object(s.a)(v,2),w=C[0],y=C[1],S=Object(a.useState)(0),z=Object(s.a)(S,2),B=z[0],U=z[1],Y=Object(a.useState)([]),$=Object(s.a)(Y,2),H=$[0],R=$[1],M=h.a.useForm(),V=Object(s.a)(M,1)[0],G=Object(a.useState)(t.items),K=Object(s.a)(G,2),Q=K[0],W=K[1];function X(e){fetch("/api/items/".concat(e),{method:"DELETE"}).then((function(t){if(t.ok){var n=Q.filter((function(t){return t.id!==e}));W(n)}}))}console.log(Q);var Z=d.a.confirm,ee=Object(f.jsx)(o.b,{direction:"vertical",children:t.users.map((function(e){return Object(f.jsxs)(o.b,{children:[Object(f.jsx)(A.a,{icon:Object(f.jsx)(_.a,{})}),e.full_name]},e.id)}))}),te=((Q.reduce((function(e,t){return e+t.price}),0)-Q.filter((function(e){return e.user_id===n.id})).reduce((function(e,t){return e+t.price}),0))/t.users.length).toFixed(2);return Object(f.jsxs)("div",{id:"tabcard",children:[Object(f.jsxs)(o.b,{children:[Object(f.jsxs)(b.a,{onClick:function(){g(!0)},children:[Object(f.jsx)(N.a,{}),"New Item"]}),Object(f.jsx)(d.a,{title:"Create New Item",visible:x,onOk:function(){g(!1)},onCancel:function(){g(!1)},footer:null,children:Object(f.jsxs)(h.a,{name:"newitem",form:V,labelCol:{span:6},wrapperCol:{span:16},autoComplete:"off",onFinish:function(){fetch("/api/items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tab_id:t.id,name:w,price:B,completed:!1,user_id:n.id})}).then((function(e){e.ok?e.json().then((function(e){W([].concat(Object(k.a)(Q),[e])),T.b.success("New Item Created!"),g(!1)})):e.json().then((function(e){return R([].concat(Object(k.a)(H),[e.errors]))}))})),V.resetFields()},children:[Object(f.jsx)(h.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please input item name!"}],children:Object(f.jsx)(m.a,{name:"name",onChange:function(e){y(e.target.value)}})}),Object(f.jsx)(h.a.Item,{label:"Cost",name:"cost",rules:[{required:!0,message:"Please input item cost!"}],children:Object(f.jsx)(P.a,{style:{width:"100%"},step:"0.0001",name:"cost",onChange:function(e){return U(e)}})}),Object(f.jsx)(h.a.Item,{wrapperCol:{offset:10,span:16},children:Object(f.jsx)(b.a,{htmlType:"submit",children:"Submit"})})]})}),Object(f.jsx)(q.a,{title:"Are you sure you want to delete this tab? All items will be deleted all together. Think twice!!",visible:j,onConfirm:function(){setTimeout((function(){u(!1)}),2e3),c(t.id)},onCancel:function(){console.log("Clicked cancel button"),u(!1)},okText:"Yes",children:Object(f.jsxs)(b.a,{onClick:function(){u(!0)},children:[Object(f.jsx)(F.a,{}),"Delete Tab"]})}),Object(f.jsxs)(b.a,{onClick:function(){Z({title:"Are you sure settle this tab?",icon:Object(f.jsx)(I.a,{}),content:"Once you settle, no one will be able to add items and you can see bill splitting result in completed tabs section.",okText:"Yes",okType:"primary",onOk:function(){i(t.id)}})},children:[Object(f.jsx)(E.a,{}),"Settle"]}),Object(f.jsx)(D.a,{placement:"bottomLeft",content:ee,trigger:"click",children:Object(f.jsxs)(b.a,{children:[Object(f.jsx)(L.a,{}),"Participants"]})}),"You Currently owe:  $",te]}),Object(f.jsx)("div",{id:"itemcard",children:Q.length>0?Object(f.jsx)(o.b,{direction:"vertical",children:Q.map((function(e){return Object(f.jsx)(J,{item:e,handleDelete:X},e.id)}))}):Object(f.jsx)("h2",{children:"No item at the moment, please add new items!"})})]})};var B=function(e){var t=e.user,n=S.a.Panel,c=Object(a.useState)([]),i=Object(s.a)(c,2),r=i[0],o=i[1];Object(a.useEffect)((function(){fetch("/api/tabs").then((function(e){return e.json()})).then((function(e){var t=e.filter((function(e){return!0!==e.completed}));o(t)}))}),[]);var l=function(e){fetch("/api/tabs/".concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then(o(r.filter((function(t){return t.id!==e}))))};function j(e){fetch("/api/tabs/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({completed:!0})}).then((function(t){if(t.ok){var n=r.filter((function(t){return t.id!==e}));o(n),T.b.success("Settle successful, check it out in Completed Tabs")}}))}return Object(f.jsx)("div",{id:"currenttabs",children:Object(f.jsx)(S.a,{children:r.map((function(e){return Object(f.jsx)(n,{header:e.name,children:Object(f.jsx)(z,{user:t,tab:e,handleDeleteTab:l,handleSettle:j})},e.id)}))})})},U=n(46),Y=n.n(U),$=n(66),H=n(12),R=n(263),M=n(258),V=n(131),G=n.n(V),K=["fetchOptions","debounceTimeout"];var Q=function(e){var t=e.fetchOptions,n=e.debounceTimeout,c=void 0===n?800:n,i=Object(H.a)(e,K),r=Object(a.useState)(!1),o=Object(s.a)(r,2),l=o[0],j=o[1],b=Object(a.useState)([]),d=Object(s.a)(b,2),O=d[0],h=d[1],m=Object(a.useRef)(0),p=Object(a.useMemo)((function(){return G()((function(e){m.current+=1;var n=m.current;h([]),j(!0),t(e).then((function(e){n===m.current&&(h(e),j(!1))}))}),c)}),[t,c]);return Object(f.jsx)(R.a,Object(u.a)(Object(u.a)({labelInValue:!0,size:"large",filterOption:!1,onSearch:p,notFoundContent:l?Object(f.jsx)(M.a,{size:"small"}):null},i),{},{options:O}))};var W=function(e){var t=e.curr_user,n=Object(a.useState)([]),c=Object(s.a)(n,2),i=c[0],r=c[1],o=Object(a.useState)(""),l=Object(s.a)(o,2),j=l[0],u=l[1],d=h.a.useForm(),O=Object(s.a)(d,1)[0],p=Object(a.useState)([]),x=Object(s.a)(p,2),g=x[0],v=x[1];function C(){return(C=Object($.a)(Y.a.mark((function e(t){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("/api/users").then((function(e){return e.json()})).then((function(e){return e.map((function(e){return{label:"".concat(e.id," ").concat(e.full_name),value:e.email}}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}console.log(t.id);var w=function(){T.b.success("New Tab Created!")};return Object(f.jsx)("div",{id:"newtab",children:Object(f.jsxs)(h.a,{form:O,layout:"vertical",wrapperCol:{span:13},onFinish:function(){fetch("/api/tabs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:j,completed:!1})}).then((function(e){e.ok?e.json().then((function(e){!function(e){var n=i.map((function(e){return e.label.split(" ")[0]}));-1===n.indexOf(t.id.toString())&&n.push(t.id.toString());n.map((function(t){fetch("/api/usertabs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:parseInt(t),tab_id:e})}).then((function(e){e.ok?e.json().then((function(e){console.log(e)})):e.json().then((function(e){return v([].concat(Object(k.a)(g),[e.errors]))}))}))})),O.resetFields()}(e.id),w()})):e.json().then((function(e){return v([].concat(Object(k.a)(g),[e.errors]))}))}))},children:[Object(f.jsx)(h.a.Item,{label:"Tab Name",name:"name",rules:[{required:!0,message:"Please input new tab name!"}],children:Object(f.jsx)(m.a,{onChange:function(e){u(e.target.value)},size:"large"})}),Object(f.jsx)(h.a.Item,{label:"Participants",name:"participants",rules:[{required:!0,message:"Please select tab participants!"}],children:Object(f.jsx)(Q,{mode:"multiple",value:i,placeholder:"Select users",fetchOptions:function(e){return C.apply(this,arguments)},onChange:function(e){r(e)}})}),Object(f.jsx)(b.a,{htmlType:"submit",size:"large",children:"Submit"})]})})};var X=function(e){var t=e.tab,n=e.user,a=[];t.users.forEach((function(e){var n=t.items.filter((function(t){return t.user_id===e.id})).reduce((function(e,t){return e+t.price}),0).toFixed(2);a.push({name:e.full_name,expense:n})}));var c=a.find((function(e){return e.name===n.full_name})).expense,i=a.filter((function(e){return e.name!==n.full_name}));return console.log(a),Object(f.jsx)(f.Fragment,{children:i.map((function(e){return e.expense-c>=0?Object(f.jsxs)("p",{children:["You owe ",e.name," $",((e.expense-c)/a.length).toFixed(2)]}):Object(f.jsxs)("p",{children:[e.name," will pay you $",((c-e.expense)/a.length).toFixed(2)]})}))})};var Z=function(e){var t=e.user,n=S.a.Panel,c=Object(a.useState)([]),i=Object(s.a)(c,2),r=i[0],o=i[1];return Object(a.useEffect)((function(){fetch("/api/tabs").then((function(e){return e.json()})).then((function(e){var t=e.filter((function(e){return!0===e.completed}));o(t)}))}),[]),Object(f.jsx)("div",{id:"currenttabs",children:Object(f.jsx)(S.a,{children:r.map((function(e){return Object(f.jsx)(n,{id:"completedPanel",header:e.name,children:Object(f.jsx)(X,{tab:e,user:t})},e.id)}))})})},ee=v.a.Header,te=v.a.Content,ne=v.a.Sider;var ae=function(e){var t=e.setUser,n=e.user;return Object(f.jsxs)(v.a,{className:"box",children:[Object(f.jsx)(ee,{className:"header",children:Object(f.jsx)("h1",{children:"Tab-Tab-Tab"})}),Object(f.jsxs)(v.a,{children:[Object(f.jsx)(ne,{width:300,id:"sidebar",children:Object(f.jsxs)(C.a,{mode:"inline",children:[Object(f.jsxs)(C.a.Item,{disabled:!0,icon:Object(f.jsx)(w.a,{}),children:["Hello, ",n.full_name]},0),Object(f.jsx)(C.a.Item,{children:Object(f.jsx)(r.b,{to:"/",children:"Current Tabs"})},1),Object(f.jsx)(C.a.Item,{children:Object(f.jsx)(r.b,{to:"/new",children:"Start New Tab"})},2),Object(f.jsx)(C.a.Item,{children:Object(f.jsx)(r.b,{to:"/archieves",children:"Completed Tabs"})},3),Object(f.jsx)(C.a.Item,{onClick:function(){fetch("/api/logout",{method:"DELETE"}).then((function(e){e.ok&&t(null)}))},children:"Logout"},4)]})}),Object(f.jsx)(v.a,{children:Object(f.jsx)(te,{id:"content",children:Object(f.jsxs)(y.c,{children:[Object(f.jsx)(y.a,{path:"/",element:Object(f.jsx)(B,{user:n})}),Object(f.jsx)(y.a,{path:"/new",element:Object(f.jsx)(W,{curr_user:n})}),Object(f.jsx)(y.a,{path:"/archieves",element:Object(f.jsx)(Z,{user:n})})]})})})]})]})};var ce=function(){var e=Object(a.useState)(null),t=Object(s.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){fetch("/api/me").then((function(e){e.ok&&e.json().then((function(e){return c(e)}))}))}),[]),n?Object(f.jsx)("div",{className:"App",children:Object(f.jsx)(ae,{setUser:c,user:n})}):Object(f.jsx)("div",{className:"App",children:Object(f.jsx)(g,{onLogin:c})})};n(255);i.a.render(Object(f.jsx)(r.a,{children:Object(f.jsx)(ce,{})}),document.getElementById("root"))}},[[256,1,2]]]);
//# sourceMappingURL=main.2289b5e8.chunk.js.map